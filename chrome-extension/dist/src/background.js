(()=>{"use strict";({994:function(){this&&this.__awaiter;let e={connected:!1};chrome.runtime.onMessage.addListener(((s,r,o)=>{switch(console.log("Background script received message:",s),s.type){case"checkConnection":return o({connected:e.connected}),!1;case"START_COMPARISON":return chrome.tabs.query({active:!0,currentWindow:!0},(e=>{var s;(null===(s=e[0])||void 0===s?void 0:s.id)?(console.log("Sending INIT_COMPARISON to tab:",e[0].id),chrome.tabs.sendMessage(e[0].id,{type:"INIT_COMPARISON"},(()=>{o({success:!0})}))):o({success:!1,error:"No active tab found"})})),!0;case"FIGMA_FRAMES":return chrome.tabs.query({active:!0,currentWindow:!0},(e=>{var r;(null===(r=e[0])||void 0===r?void 0:r.id)?(console.log("Forwarding frames to content script:",s.frames),chrome.tabs.sendMessage(e[0].id,{type:"FIGMA_FRAMES",frames:s.frames},(()=>{o({success:!0})}))):o({success:!1,error:"No active tab found"})})),!0;case"figma-frames":return chrome.tabs.query({active:!0,currentWindow:!0},(e=>{const r=e[0];r&&r.id?chrome.tabs.sendMessage(r.id,{type:"figma-frames",frames:s.frames},(e=>{console.log("Content script response:",e),o(e)})):(console.error("No active tab found"),o({success:!1,error:"No active tab found"}))})),!0;default:return o({success:!1,error:"Unknown message type"}),!1}})),chrome.runtime.onMessageExternal.addListener(((s,r,o)=>{var n;switch(console.log("Received external message:",s,"from:",r),s.type){case"figmaConnect":e.connected=!0,e.tabId=null===(n=r.tab)||void 0===n?void 0:n.id,o({success:!0}),chrome.runtime.sendMessage({type:"connectionUpdate",connected:!0});break;case"send-to-extension":return s.frames&&Array.isArray(s.frames)?(console.log("Received frames from Figma:",s.frames),chrome.tabs.query({active:!0,currentWindow:!0},(e=>{const r=e[0];(null==r?void 0:r.id)?(console.log("Forwarding frames to content script:",s.frames),chrome.tabs.sendMessage(r.id,{type:"FIGMA_FRAMES",frames:s.frames},(e=>{console.log("Content script response:",e),o({success:!0})}))):(console.error("No active tab found"),o({success:!1,error:"No active tab found"}))})),!0):(console.error("Invalid frame data received:",s),o({success:!1,error:"Invalid frame data"}),!0);default:return console.warn("Unknown message type:",s.type),o({success:!1,error:"Unknown message type"}),!1}return!0})),chrome.action.onClicked.addListener((e=>{e.id&&chrome.tabs.sendMessage(e.id,{type:"TOGGLE_UI"}).catch((e=>{console.error("Error sending message:",e)}))}))}})[994]()})();